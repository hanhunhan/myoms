<link rel="stylesheet" href="./Tpl/css/jquery.treeview.css" />
<script src="./Tpl/js/jquery.treeview.js" type="text/javascript"></script>
<script src="./Tpl/js/jquery.cookie.js" type="text/javascript"></script>
<script type="text/javascript">
	function reset(){
		$('#nodeid').val('');
		$('#channelname').html('请选择频道');
		$('.change-sms').hide();
	}
	
jQuery(function(){

	jQuery('.channel').each(function(){
		
		jQuery(this).bind('click',function(){
		

		var offset = jQuery(this).offset();
		jQuery('.change-sms').css({
			'left':offset.left+'px',
			'top':offset.top+25+'px'
		}).show();

		return false;
	});
	})
	
	jQuery('.close').bind('click',function(){
		jQuery('.change-sms').hide()
	});

	$(".box").bind("click",function(){
		jQuery('.change-sms').hide()
	})

})


$(function() {
	$("#tree").treeview({
		collapsed: true,
		animated: "fast",
		control:"#sidetreecontrol",
		prerendered: true,
		persist: "location"
	});

	$('.node').bind("dblclick",function(){
		var nodename = $(this).attr('tit');
		var nodeid = $(this).attr('val');
		$('#channelname').html(nodename);
		$('#nodeid').val(nodeid);
		$('.change-sms').hide();
		
	})
})

</script>
<!--操作-->
<div class="change-sms" style="z-index:999;">
	<div class="hd"><h4>{$nodename}</h4><a href="javascript:void(0)" class="close">关闭</a></div>
	<div class="bd">
		<div class="center-btn mt10">								
		<ul id="tree" class="treeview">
		    <php>
				if(is_array($channelist)){
					foreach($channelist as $vo){
						echo '<li class="expandable"><div class="hitarea expandable-hitarea"></div><a class="node" tit="'.$vo['title'].'" val="'.$vo['nodeid'].'">'.$vo['title'].'</a>';
						echo '<ul style="display: none;">';
						if(is_array($vo['child'])){
								$t = count($vo['child']);$n=1;
								foreach($vo['child'] as $val){
									echo '<li class="expandable"><div class="hitarea expandable-hitarea"></div><a class="node" tit="'.$val['title'].'" val="'.$val['nodeid'].'">'.$val['title'].'</a>';
									echo '<ul style="display: none;">';
									if(is_array($val['child'])){
										$c = count($val['child']);$m=1;
										foreach($val['child'] as $v){
											if($c==$m) $cls = 'class="last"'; else $cls = '';
											$m++;
											echo '<li '.$cls.'><a class="node" tit="'.$v['title'].'" val="'.$v['nodeid'].'">'.$v['title'].'</a></li>';
										}
									}
									echo '</ul>';
								}
						}
						echo '</ul>';
					}
				}
			</php>
			<!--<foreach name="channelist" item="vo" >
			<li class="expandable"><div class="hitarea expandable-hitarea"></div><a class="node" tit="{$vo.title}" val="{$vo.nodeid}">{$vo.title}</a>
			<ul style="display: none;">
				<foreach name="vo.child" item="val" >
				<li class="expandable"><div class="hitarea expandable-hitarea"></div><a class="node" tit="{$val.title}" val="{$val.nodeid}">{$val.title}</a>
				<ul style="display: none;">
					<foreach name="val.child" item="v" >
						<li><a class="node" tit="{$v.title}" val="{$v.nodeid}">{$v.title}</a></li>
					</foreach>
				</ul>
				</foreach>
				</li>
			</ul>
			</foreach>-->
			<li class="last"><a href="javascript:void(0)" onclick="reset()">清空设置</a></li>
		</ul>
		</div>
	</div>
</div>
<!--操作-->