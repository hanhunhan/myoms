<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>报表</title>
	<link rel="stylesheet" type="text/css" href="./Public/easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="./Public/easyui/themes/icon.css">
<script type="text/javascript" src="./Public/validform/js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="./Public/easyui/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="./Public/easyui/report.js"></script>
	<script type="text/javascript" src="./Public/easyui/locale/easyui-lang-zh_CN.js"></script>
</head>
<body>
	<h2> </h2>
	<div style="margin-bottom:10px">
		<a href="javascript:void(0)" class="easyui-menubutton" style="width:70px;height:78px;" data-options="size:'large',iconCls:'icon-load',iconAlign:'top',plain:false,menu:'#mm'">数据源</a>
		<a href="javascript:void(0)" class="easyui-linkbutton" style="width:70px;height:78px;" data-options="size:'large',iconCls:'icon-layout',iconAlign:'top',plain:false" onclick="javascript:$('#pg').pivotgrid('layout')"> 布局</a>
	 
	</div>
	<div id="mm" style="display:none">
	<volist name="dataSource" id="vo">
		<div onclick="loadDatasource({$vo.ID})">{$vo.NAME}</div>
	</volist>	 
	</div>
	<table id="pg" style="  "></table>
	<style type="text/css">
		.icon-load{
			background:url('./Public/easyui/load.png') no-repeat center center;
		}
		.icon-layout{
			background:url('./Public/easyui/layout.png') no-repeat center center;
		}
	</style>
	<script type="text/javascript">
		$(function(){
			load();
			
			 
		});
		function loadDatasource(id){
			var url = window.location.href;
			
			window.location.href = url.split('&dbsourceId')[0]+'&dbsourceId='+id;
		}
		function save(){
			//alert($('#pg').pivotgrid('layout').getFields('rows'));
		}
		function load(){
			$('#pg').pivotgrid({
				url:location.href+'&getJson=1',
				method:'get',
				pivot:{
					//rows:[{$rows}],
					rows:[],
					//columns:[{$columns}],
					columns:[], 
					//values:[{$values} ],
					values:[],
					//filters:[{$tbl}],
					filters:[],
					filterRules:{}
				},
				valuePrecision:0,
				valueStyler:function(value,row,index){
					if (/Discount$/.test(this.field) && value>100 && value<500){
						return 'background:#D8FFD8'
					}
				}
			})
		}
		 
	</script>
</body>
</html>