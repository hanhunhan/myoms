<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>权限管理</title>
<link rel=stylesheet href="./Tpl/css/global.css" type="text/css">
<link rel=stylesheet href="./Tpl/css/mainPage.css" type="text/css">
<script type="text/javascript" src="./Tpl/js/jquery-1.5.2.min.js"></script>
<script>
	function checkinfo(){
		var username = $('#username').val();
		username = username.replace(/^\s+|\s+$/,'');
		if(username=='') {
			$('#username_error').html('<font class="fred">*姓名不能为空！<font>');
			return false;
		}else
			$('#username_error').html('');
		
		var mo = $('#mo').val();
		if(mo!=''){
			var reg = /^\d{11}$/
			if(!reg.test(mo)){
				$('#mo_error').html('<font class="fred">*手机号码格式不正确！<font>');
				return false;
			}else
				$('#mo_error').html('');
		}

		var qq = $('#qq').val();
		if(qq!=''){
			var reg = /^\d+$/
			if(!reg.test(qq)){
				$('#qq_error').html('<font class="fred">*QQ格式不正确！<font>');
				return false;
			}else
				$('#qq_error').html('');			
		}

		var email = $('#email').val();
		if(email!=''){
			var reg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
			if(!reg.test(email)){
				$('#email_error').html('<font class="fred">*邮箱格式不正确！<font>');
				return false;
			}else
				$('#email_error').html('');	
		}
	}

	function checkpwd(){
		var oldpwd = $('#oldpwd').val();
		if(oldpwd==''){
			$('#oldpwd_error').html('<font class="fred">*请输入密码！<font>');
			return false;
		}else{
			$('#oldpwd_error').html('');
		}
		var newpwd = $('#newpwd').val();
		if(newpwd==''){
			$('#newpwd_error').html('<font class="fred">*请输入新的密码！<font>');
			return false;
		}else{
			if(newpwd.length <8){
				$('#newpwd_error').html('<font class="fred">*新的密码复杂度不够！密码长度不少于8位，必须是字母大写，字母小写，数字，特殊字符中任意三个组合，请重新设置！！<font>');
				return false;
			}else{
				var ls = 0;
				var a=/([a-z])+/.exec(newpwd);
				var b=/([0-9])+/.exec(newpwd);
				var c=/([A-Z])+/.exec(newpwd);
				var d=/[^a-zA-Z0-9]+/.exec(newpwd);
				if(a){
					ls++;
				}
				if(b){
					ls++;
				}
				if(c){
					ls++;
				}
				if(d){
					ls++;
				}
				if(ls<3){
					$('#newpwd_error').html('<font class="fred">*新的密码复杂度不够！密码长度不少于8位，必须是字母大写，字母小写，数字，特殊字符中任意三个组合，请重新设置！！<font>');
					return false;
				}else{
					$('#newpwd_error').html('');
				}
			}
		}

		var repwd = $('#repwd').val();

		if(repwd==''){
			$('#repwd_error').html('<font class="fred">*请再次输入新密码！<font>');
			return false;			
		}else{
			$('#repwd_error').html('');
		}


		if(newpwd!=repwd){
			$('#repwd_error').html('<font class="fred">*两次输入的密码不一致！<font>');
			return false;			
		}else{
			$('#repwd_error').html('');
		}			
	}
</script>
</head>

<body>
	<div class="box" id="interestManage">
    	<div class="box-tit"><h3>个人信息</h3></div>
        <div class="box-con">

        	<div class="c-tit"><h4>基本信息</h4></div>
            <div class="search-condition">
				<form method="post" action="{:U('User/userinfo')}" onsubmit="return checkinfo()">
            	<div class="search-con">
					<table class="table2" style="width:90%">
						<tr><td style="width:100px;">姓名：</td><td><input type="text" name="username" id="username" value="{$userinfo.LOAN_TRUENAME}"><span id="username_error"></span></td>
						<tr><td>部门：</td><td>{$depart[$userinfo[LOAN_USERDEPART]]}</td>
						<tr><td>职务：</td><td>{$userinfo.LOAN_POS}</td>
						<tr><td>手机号码：</td><td><input type="text" name="mo" id="mo" value="{$userinfo.LOAN_MOBILE}"><span id="mo_error"></span></td>
						<tr><td>QQ：</td><td><input type="text" name="qq" id="qq" value="{$userinfo.LOAN_QQ}"><span id="qq_error"></span></td>
						<tr><td>邮箱：</td><td><input type="text" name="email" id="email" style="width:250px" value="{$userinfo.LOAN_EMAIL}"><span id="email_error"></span></td>
					</table>
				</div>
                <div class="center-btn mt10"><input type="submit" value="确定" class="btn-a mr50"/>
				<input name="重置" type="reset" class="btn-a" value="重填"/></div>
				</div>
				<input type="hidden" name="act" value="edit">
				</form>


				<div class="c-tit"><h4>密码修改</h4></div>
				<div class="search-condition">
				<form method="post" action="{:U('User/userinfo')}"  onsubmit="return checkpwd();">
            	<div class="search-con">
					<table class="table2" style="width:90%">
						<tr><td style="width:100px;">旧密码：</td><td><input type="text" name="oldpwd" id="oldpwd" ><span id="oldpwd_error"></span></td>
						<tr><td>新密码：</td><td><input type="text" name="newpwd" id="newpwd"><span id="newpwd_error"></span></td>
						<tr><td>再次输入新密码：</td><td><input type="text" name="repwd" id="repwd" ><span id="repwd_error"></span></td>
					</table>
				</div>
                <div class="center-btn mt10"><input type="submit" value="确定" class="btn-a mr50"/>
				<input name="重置" type="reset" class="btn-a" value="重填"/></div>
				</div>
				<input type="hidden" name="act" value="pwd">
				</form>
				</div>
            </div>


        </div>
    </div>
</body>
</html>
